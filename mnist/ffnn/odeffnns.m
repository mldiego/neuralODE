function dx = odeffnns(x,u)
% Neural ODE from example
% Parameters of neural ode (10 neurons each layer)
w1 = [-0.43339211,-1.1391568,-0.58836538,-0.061450981,-0.23676823,-0.15580809,-0.70503002,0.16148482,-0.19018874,-0.63357460,-0.035834115,0.29723349,-1.0598044,-0.28020915,0.13389431,0.025944915;
    0.43321195,0.037794363,-1.1576010,0.44461098,-0.55008268,-0.36208627,-0.69618350,-0.29279679,0.19379617,-0.44480723,-0.14781685,0.46172541,-0.55457187,-0.76173782,0.35644093,0.29524761;
    0.52926654,-0.22254226,0.067811772,-0.31033930,0.17569426,0.55078226,0.39968926,0.036999781,-0.12337326,-0.14396359,0.029162355,-0.44313553,0.47439048,0.027073292,0.43888804,0.44339550;
    0.084569387,0.42639863,0.27843580,0.48232743,-0.52349675,0.24053985,0.47505301,0.27847707,0.46630347,-0.40999827,0.35173535,-0.57263905,-0.16448708,0.15979534,0.22302996,0.10521514;
    0.50836146,-0.36659250,-0.029207719,0.47385922,-0.46867424,-0.18756166,-0.13483024,0.52112544,0.16528039,-0.64740360,0.36134163,0.34529835,0.65351075,-0.11032362,0.067091152,0.038820930;
    -0.46241152,0.20162287,-0.090573303,-0.62537324,0.25708568,0.22990577,-0.55867577,-0.67383242,-1.2999214,-0.10843657,0.41013098,0.52256078,-0.65931779,0.58465284,-0.15414155,-0.62125391;
    0.34586218,0.31616890,-0.31474635,-0.44654575,-0.032864682,-0.47428659,-0.028646555,-0.64766043,0.54288775,0.32373625,0.17219275,-1.0994302,0.48501334,0.61263978,-0.58687806,-0.19289388;
    0.12861903,-0.34345132,-0.26235482,1.0089157,0.34481940,-0.62944621,-0.24013895,-0.17905612,0.60822690,-0.18780214,0.65524983,-0.25631741,0.11031745,-0.47166920,0.42837539,0.31491095;
    0.18410848,-0.24241827,-0.048236337,-0.020581961,-0.11187379,0.36073926,-1.1000606,0.053574849,-0.097933196,0.22220542,0.021703245,0.18016452,-0.55185449,-0.34200761,0.49291652,-0.65779984;
    0.12540625,0.33565214,-0.31060004,-0.40245894,0.51102763,-0.14347686,0.57292855,0.24502344,0.41344166,-0.31714228,0.15218866,-0.14171593,0.13816904,-0.28898755,0.14199787,-0.52897322];
b1 = [0.16657844,-0.14680140,-0.069720648,0.069268525,0.081557982,0.050939679,-0.097947463,0.071706131,-0.38517404,-0.031588502]';
% Layer 2
w2 = [0.31830728,-0.73061192,-0.31310120,-0.0088407258,0.17165266,0.045212433,-0.24761350,-0.31215873,-0.18447839,0.066321522;
    0.76806968,-0.44415799,0.038282510,-0.61014366,0.15194696,-0.088817172,0.17942642,0.080820307,-0.062447377,-0.084895745;
    0.068475649,0.16827804,0.13063625,-0.43993512,-0.19740617,0.46293485,0.71706146,-0.52545959,-0.29180118,0.26956189;
    -0.080014534,-0.76096159,0.30518231,-0.039799843,0.32097235,-0.36233768,-0.054816719,-1.1357988,-0.28895390,0.63839227;
    0.38837096,0.41885194,-0.18591776,0.30002129,0.31502780,-0.18572493,0.24812743,-0.41333276,0.19868381,-0.25477096;
    -0.11235908,-0.14879690,-0.59629202,-0.56391013,-0.18716860,0.089655302,0.64241552,0.14435332,-0.42326334,0.50104254;
    0.20254935,-0.40116456,-0.84917760,-0.79354256,0.74687743,0.61261278,0.95937854,-0.47987249,0.65304685,0.19114242;
    -0.44264477,-0.15116474,0.29211563,0.012778453,-0.81861782,0.50210142,0.078532957,-0.028512793,-0.45623681,-0.49076304;
    -0.20536831,-0.47719795,0.23852929,0.16081963,0.59617901,0.47604004,-0.70345849,-0.61631966,-0.084167682,0.015422815;
    0.60443282,0.40488869,-0.33861905,0.15722042,0.60036039,0.46926537,0.36496001,0.12210562,-0.33431521,0.67667568;
    -0.084388748,0.19825876,-0.10143637,-0.12733278,-0.14436840,-0.48861155,-0.23086658,-0.55464029,0.024900516,-0.11562971;
    0.046601310,-0.083390132,0.86211938,0.54024631,-0.71970826,-0.027557041,0.38193631,0.36609536,0.31845024,-0.26858816;
    0.51903421,-0.11803862,-0.78038758,0.17137678,-0.34902772,0.37873885,0.14730510,-0.45358625,0.26567805,0.35321814;
    0.34262544,0.54534286,-0.22098894,-0.59153217,-0.29968110,0.10033697,0.031073339,0.50165188,0.22620051,0.61191684;
    -0.40772364,-0.72287428,-0.28194964,0.34775817,0.48876974,-0.064052716,-0.049992125,-0.65803748,-0.67517585,-0.19177435;
    -0.64269835,-1.0392470,-0.15916346,0.43445671,0.54958141,-0.035538647,-0.23438020,-0.90505362,0.34059015,0.57817447];
b2 = [-0.85851562,-0.41314915,0.40950635,0.31534296,-0.016215641,-0.44298387,0.45472735,0.28950077,0.68640792,-0.084017873,0.76936054,-0.38396972,-0.63522333,0.33835655,-0.66892719,-0.14058101]';

% Function
x = x.^3;
% dx = tanh(w1*u+b1); %layer 1
dx = w2*tanh(w1*x+b1)+b2; % Full dynamics in one line

end

